[
  {
    "name": "Welcome",
    "preAction": [
      {
        "text": [
          {
            "en": "Welcome! Let's help you join a new community.",
            "hi": "स्वागत है! आइए आपको एक नए समुदाय में शामिल होने में मदद करते हैं।",
            "default": "Welcome! Let's help you join a new community."
          }
        ]
      },
      {
        "menu": [
          {
            "label": "सूची से चुनें",
            "value": "state_district",
            "caption": "आपकी बेहतर सेवा के लिए, हमें आपकी लोकेशन की आवश्यकता है। आप अपनी लोकेशन कैसे भेजना चाहते हैं? \n1. आप राज्य और ज़िले की सूची में से अपनी लोकेशन चुन सकते हैं। \n2. बस अपनी लोकेशन भेजें।"
          },
          {
            "label": "स्थान भेज देंगे",
            "value": "location_pin"
          }
        ]
      }
    ],
    "postAction": [],
    "transition": [
      {
        "SendState": [
          "state_district"
        ]
      },
      {
        "SendLocationRequest": [
          "location_pin"
        ]
      },
      {
        "Welcome": [
          "failure"
        ]
      }
    ]
  },
  {
    "name": "SendState",
    "preAction": [
      {
        "function": "send_states"
      }
    ],
    "postAction": [
      {
        "function": "move_forward"
      }
    ],
    "transition": [
      {
        "SendDistrict": [
          "success"
        ]
      },
      {
        "SendState": [
          "failure"
        ]
      }
    ]
  },
  {
    "name": "SendDistrict",
    "preAction": [
      {
        "data": {
          "getDataFrom": {
            "field": "misc",
            "state": "SendState"
          }
        },
        "function": "send_districts"
      }
    ],
    "postAction": [
      {
        "function": "move_forward"
      }
    ],
    "transition": [
      {
        "CommunityByStateDistrict": [
          "success"
        ]
      },
      {
        "SendDistrict": [
          "failure"
        ]
      }
    ]
  },
  {
    "name": "SendLocationRequest",
    "preAction": [
      {
        "function": "send_location_request"
      }
    ],
    "postAction": [
      {
        "function": "move_forward"
      }
    ],
    "transition": [
      {
        "CommunityByLocation": [
          "success",
          "community_member"
        ]
      },
      {
        "SendLocationRequest": [
          "failure"
        ]
      }
    ]
  },
  {
    "name": "CommunityByLocation",
    "preAction": [
      {
        "data": {
          "getDataFrom": {
            "field": "data",
            "state": "SendLocationRequest"
          }
        },
        "function": "send_community_by_location"
      }
    ],
    "postAction": [
      {
        "function": "move_forward"
      }
    ],
    "transition": [
      {
        "AddUserToCommunity": [
          "success"
        ]
      },
      {
        "NoCommunitiesMsg": [
          "no_communities"
        ]
      },
      {
        "CommunityByLocation": [
          "failure"
        ]
      }
    ]
  },
  {
    "name": "CommunityByStateDistrict",
    "preAction": [
      {
        "data": {
          "getDataFrom": [
            {
              "field": "misc",
              "state": "SendState"
            },
            {
              "field": "misc",
              "state": "SendDistrict"
            }
          ]
        },
        "function": "send_community_by_state_district"
      }
    ],
    "postAction": [
      {
        "function": "move_forward"
      }
    ],
    "transition": [
      {
        "AddUserToCommunity": [
          "success"
        ]
      },
      {
        "CommunityByStateDistrict": [
          "failure"
        ]
      }
    ]
  },
  {
    "name": "AddUserToCommunity",
    "preAction": [
      {
        "function": "add_user_to_selected_community_join_flow"
      }
    ],
    "postAction": [],
    "transition": [
      {
        "JoinSuccess": [
          "success"
        ]
      },
      {
        "AddUserToCommunity": [
          "failure"
        ]
      }
    ]
  },
  {
    "name": "JoinSuccess",
    "preAction": [
      {
        "function": "send_join_success_message"
      },
      {
        "function": "store_active_community_and_context"
      },
      {
        "data": [
          {
            "smjName": "community_features",
            "initState": "ServiceMenuNew"
          }
        ],
        "function": "jumpToSmj"
      }
    ],
    "postAction": [],
    "transition": [
      {
        "COMPLETE": [
          "success"
        ]
      },
      {
        "JoinSuccess": [
          "failure"
        ]
      }
    ]
  },
  {
    "name": "NoCommunitiesMsg",
    "preAction": [
      {
        "text": [
          {
            "en": "Sorry we don't have any communities for you exact location.\n\nSend \"Hi\" to restart the service.",
            "hi": "क्षमा करें, आपके सटीक स्थान के लिए हमारे पास कोई समुदाय नहीं है। \n\nदोबारा सेवा का लाभ उठाने के लिए \"Hi\" भेजें।",
            "default": "Sorry we don't have any communities for you exact location.\n\nSend \"Hi\" to restart the service."
          }
        ]
      },
      {
        "function": "archive_and_end_session"
      }
    ],
    "postAction": [],
    "transition": [
      {
        "NoCommunitiesMsg": [
          "failure"
        ]
      }
    ]
  }
]